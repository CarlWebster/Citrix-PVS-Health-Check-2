#Carl Webster, CTP
#webster@carlwebster.com
#@carlwebster on Twitter
#http://www.CarlWebster.com
#V2 script created February 23, 2022
#released to the community on 14-Mar-2022
#V2.00 is based on 1.24
#

#Version 2.00 14-Mar-2022
#	Added MultiSubnetFailover to Farm Status section
#		Thanks to Arnaud Pain
#		I can't believe no one has asked for this since PVS 7.11 was released on 14-Sep-2016
#	Added the following functions to support Word/PDF and HTML output and new parameters:
#		AddHTMLTable
#		AddWordTable
#		CheckWordPrereq
#		FindWordDocumentEnd
#		FormatHTMLTable
#		GetCulture
#		Get-LocalRegistryValue
#		Get-RegistryValue
#		OutputauthGroups
#		OutputNotice
#		OutputReportFooter
#		OutputWarning
#		ProcessDocumentOutput
#		SaveandCloseDocumentandShutdownWord
#		SaveandCloseHTMLDocument
#		Set-DocumentProperty
#		SetupWord
#		SetWordCellFormat
#		SetWordHashTable
#		SetWordTableAlternateRowColor
#		Test-RegistryValue
#		UpdateDocumentProperties
#		ValidateCompanyName
#		ValidateCoverPage
#		validObject
#		validStateProp
#		WriteHTMLLine
#		WriteWordLine
#	Added the following parameters:
#		AddDateTIme
#		CompanyAddress
#		CompanyEmail
#		CompanyFax
#		CompanyName
#		CompanyPhone
#		CoverPage
#		HTML
#		MSWord
#		PDF
#		ReportFooter
#		Text
#		UserName
#	Any Function in this script not listed anywhere else in this changelog was updated to support Word/PDF and HTML output
#	Changed all file names by adding a V2 somewhere in the name
#	Changed the date format for the transcript and error log files from yyyy-MM-dd_HHmm format to the FileDateTime format
#		The format is yyyyMMddTHHmmssffff (case-sensitive, using a 4-digit year, 2-digit month, 2-digit day, 
#		the letter T as a time separator, 2-digit hour, 2-digit minute, 2-digit second, and 4-digit millisecond)
#		For example: 20221225T0840107271
#	Dropped support for PVS 5. The V1.24 script still supports PVS 5.x
#	Fixed a bug in Function GetInstalledRolesAndFeatures that didn't handle the condition of no installed Roles or Features
#		Thanks to Arnaud Pain for reporting this
#	Fixed a bug when retrieving a Device Collection's Administrators and Operators
#		I was not comparing to the specific device collection name, which returned all administrators and 
#		operators for all device collections and not the device collection being processed 
#	Fixed a bug with handling a PVS server with multiple NICs and multiple IPv4 addresses
#		This bug has existed since I created the script in 2012
#		I changed the $Script:NICIPAddresses array from @{} to New-Object System.Collections.ArrayList
#		Updated Function ProcessPVSSite to use Get-NetIPAddress -CimSession to get all the IPv4 addresses
#		This allows the gathering of IPv4 addresses regardless of the OS or PVS version
#		Updated Function GetBadStreamingIPAddresses to work with the new array type for $Script:NICIPAddresses
#	Format the Farm, Properties, Status section to match the console output
#	In Function DeviceStatus, change the output of the Target device's active/inactive status and license type
#	In Function GetBootstrapInfo, for HTML output, check if any array items exist before outputting a blank table with only column headings
#	In Function GetConfigWizardInfo, fix $PXEServices to work with PVS7+
#		If DHCPType is equal to 1073741824, then if PXE is set to PVS,
#		in PVS V6, PXEType is set to 0, but in PVS7, PXEType is set to 1
#		Updated the function to check for both 0 and 1 values
#	In Function GetDisableTaskOffloadInfo, changed the value of $TaskOffloadValue:
#		If the registry value DisableTaskOffload does not exist, from "Missing" to "Not defined"
#		To a String[] so the HTML output works
#	In Function ProcessStores, change the Word/PDF and HTML output to tables instead of individual lines
#	Replaced all Get-WmiObject with Get-CimInstance
#	Replaced most script Exit calls with AbortScript to stop the transcript log if the log was enabled and started
#	Updated the following functions to the latest versions:
#		AbortScript
#		GetComputerWMIInfo
#		line
#		OutputComputerItem
#		OutputDriveItem
#		OutputNicItem
#		OutputProcessorItem
#		ProcessScriptEnd
#		SaveandCloseTextDocument
#		SendEmail
#		SetFilenames
#		SetupText
#		ShowScriptOptions
#	Updated the help text
#	Updated the ReadMe file
#	Went to Set-StrictMode -Version Latest, from Version 2 and cleaned up all related errors
#	You can select multiple output formats
